import{bc as A,b2 as E,d as J,a2 as K,T as O,h as t,x as X,B as Y,i as g,g as Q,aN as q,w as z,j as d,c as a,k as o,o as n,u as s,bd as G,a as c,p as w,be as H,bf as y,X as M,bg as Z,C as ee,aS as ue,aj as te,t as oe}from"./index-fe79b01c.js";import{u as se}from"./usePageTitle-1d4e84aa.js";function ae(){const p=[];return A(()=>p.forEach(l=>l.dismiss())),(...l)=>{const r=E(...l);return p.push(r),r}}const ne={class:"work-queue__upcoming-runs"},ce=J({__name:"WorkQueue",setup(p){const l=K(),r=O(),R=ae(),h=t(()=>{const u=["Upcoming Runs","Runs"];return X.xl||u.unshift("Details"),u}),C=Y("workQueueId"),T=t(()=>`prefect agent start ${e.value?` --work-queue "${e.value.name}"`:""}`),v=g([]),k=g(),W=()=>{v.value=["Running","Pending"],k.value="Runs"},x={interval:3e5},_=Q(r.workQueues.getWorkQueue,[C.value],x),e=t(()=>_.response),m=t(()=>{var u;return(u=e.value)==null?void 0:u.concurrencyLimit}),N=t(()=>{var u;return(u=e.value)==null?void 0:u.isPaused}),U=t(()=>!!(m.value&&m.value<=$.value&&!N.value)),b=t(()=>e.value?[e.value.name]:[]),{filter:B}=q({flowRuns:{workQueueName:b}}),F=()=>{l.push(te.workQueues())},P=t(()=>e.value?`Work Queue: ${e.value.name}`:"Work Queue"),{filter:S}=q({flowRuns:{state:{name:["Running","Pending"]},workQueueName:b.value}}),V=Q(r.flowRuns.getFlowRunsCount,[S],{interval:3e4}),$=t(()=>V.response??0);return se(P),z(()=>{var u;return(u=e.value)==null?void 0:u.deprecated},u=>{u&&R(oe.info.deprecatedWorkQueue,"default",{dismissible:!1,timeout:!1})}),(u,i)=>{const j=d("p-button"),D=d("p-tabs"),I=d("p-layout-well"),L=d("p-layout-default");return n(),a(L,{class:"work-queue"},{header:o(()=>[e.value?(n(),a(s(G),{key:0,"work-queue":e.value,onUpdate:s(_).refresh,onDelete:F},null,8,["work-queue","onUpdate"])):c("",!0)]),default:o(()=>[w(I,{class:"work-queue__body"},{header:o(()=>[w(s(H),{command:T.value,title:"Work queue is ready to go!",subtitle:"Work queues define the work to be done and agents poll a specific work queue for new work."},null,8,["command"])]),well:o(()=>[e.value?(n(),a(s(y),{key:0,alternate:"","work-queue":e.value},null,8,["work-queue"])):c("",!0)]),default:o(()=>[w(D,{selected:k.value,"onUpdate:selected":i[1]||(i[1]=f=>k.value=f),tabs:h.value},{details:o(()=>[e.value?(n(),a(s(y),{key:0,"work-queue":e.value},null,8,["work-queue"])):c("",!0)]),"upcoming-runs":o(()=>[M("div",ne,[e.value?(n(),a(s(Z),{key:0,"work-queue":e.value},null,8,["work-queue"])):c("",!0),U.value?(n(),a(j,{key:1,class:"work-queue__active-runs-button",onClick:W},{default:o(()=>[ee(" Show active runs ")]),_:1})):c("",!0)])]),runs:o(()=>[w(s(ue),{states:v.value,"onUpdate:states":i[0]||(i[0]=f=>v.value=f),"flow-run-filter":s(B)},null,8,["states","flow-run-filter"])]),_:1},8,["selected","tabs"])]),_:1})]),_:1})}}});export{ce as default};
